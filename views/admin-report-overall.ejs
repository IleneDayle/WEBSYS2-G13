<div class="container">
  <h2>Overall Sales Report</h2>

  <div class="reports-stats">
    <div class="stat-card">
      <div class="stat-number">₱<%= reportsData.totalRevenue %></div>
      <div class="stat-label">Total Revenue</div>
    </div>
    <div class="stat-card">
      <div class="stat-number"><%= reportsData.totalOrders %></div>
      <div class="stat-label">Total Orders</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">₱<%= reportsData.avgOrderValue %></div>
      <div class="stat-label">Average Order Value</div>
    </div>
    <div class="stat-card">
      <div class="stat-number"><%= reportsData.completedOrders %></div>
      <div class="stat-label">Completed Orders</div>
    </div>
  </div>

  <h3>Sales by Service (All time)</h3>
  <% if (Object.keys(reportsData.salesByService || {}).length === 0) { %>
    <p>No sales recorded.</p>
  <% } else { %>
    <table class="table">
      <thead><tr><th>Service</th><th>Orders</th><th>Revenue</th></tr></thead>
      <tbody>
        <% Object.entries(reportsData.salesByService).forEach(([service, d]) => { %>
          <tr>
            <td><%= service %></td>
            <td><%= d.count %></td>
            <td>₱<%= d.revenue %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>

  <h3>Top Customers (All time)</h3>
  <% const top = Object.entries(reportsData.salesByUser || {}).sort((a,b)=>b[1].revenue-a[1].revenue).slice(0,10); %>
  <% if (top.length === 0) { %>
    <p>No customer sales recorded.</p>
  <% } else { %>
    <table class="table">
      <thead><tr><th>Customer</th><th>Email</th><th>Orders</th><th>Revenue</th></tr></thead>
      <tbody>
        <% top.forEach(([email,d]) => { %>
          <tr>
            <td><%= d.userName || email %></td>
            <td><%= email %></td>
            <td><%= d.count %></td>
            <td>₱<%= d.revenue %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>

  <div style="margin-top:12px;">
    <a href="/admin/reports/export/pdf" class="btn">Export PDF</a>
    <a href="/admin/reports/export/csv" class="btn">Export CSV</a>
    <a href="/admin/reports/export/sheets" class="btn">Export to Google Sheets</a>
  </div>
</div>
